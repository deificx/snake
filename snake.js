!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){var n;!function(s,r,o){if(s){for(var a,h={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},c={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},u={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},l={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},f=1;f<20;++f)h[111+f]="f"+f;for(f=0;f<=9;++f)h[f+96]=f.toString();g.prototype.bind=function(t,e,i){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,i),this},g.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},g.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},g.prototype.reset=function(){return this._callbacks={},this._directMap={},this},g.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function t(e,i){return null!==e&&e!==r&&(e===i||t(e.parentNode,i))}(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var i=t.composedPath()[0];i!==t.target&&(e=i)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},g.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},g.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(h[e]=t[e]);a=null},g.init=function(){var t=g(r);for(var e in t)"_"!==e.charAt(0)&&(g[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},g.init(),s.Mousetrap=g,t.exports&&(t.exports=g),void 0===(n=function(){return g}.call(e,i,e,t))||(t.exports=n)}function p(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}function d(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return h[t.which]?h[t.which]:c[t.which]?c[t.which]:String.fromCharCode(t.which).toLowerCase()}function y(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function v(t,e,i){return i||(i=function(){if(!a)for(var t in a={},h)t>95&&t<112||h.hasOwnProperty(t)&&(a[h[t]]=t);return a}()[t]?"keydown":"keypress"),"keypress"==i&&e.length&&(i="keydown"),i}function m(t,e){var i,n,s,r=[];for(i=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),s=0;s<i.length;++s)n=i[s],l[n]&&(n=l[n]),e&&"keypress"!=e&&u[n]&&(n=u[n],r.push("shift")),y(n)&&r.push(n);return{key:n,modifiers:r,action:e=v(n,r,e)}}function g(t){var e=this;if(t=t||r,!(e instanceof g))return new g(t);e.target=t,e._callbacks={},e._directMap={};var i,n={},s=!1,o=!1,a=!1;function h(t){t=t||{};var e,i=!1;for(e in n)t[e]?i=!0:n[e]=0;i||(a=!1)}function c(t,i,s,r,o,a){var h,c,u,l,f=[],p=s.type;if(!e._callbacks[t])return[];for("keyup"==p&&y(t)&&(i=[t]),h=0;h<e._callbacks[t].length;++h)if(c=e._callbacks[t][h],(r||!c.seq||n[c.seq]==c.level)&&p==c.action&&("keypress"==p&&!s.metaKey&&!s.ctrlKey||(u=i,l=c.modifiers,u.sort().join(",")===l.sort().join(",")))){var d=!r&&c.combo==o,v=r&&c.seq==r&&c.level==a;(d||v)&&e._callbacks[t].splice(h,1),f.push(c)}return f}function u(t,i,n,s){e.stopCallback(i,i.target||i.srcElement,n,s)||!1===t(i,n)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(i),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(i))}function l(t){"number"!=typeof t.which&&(t.which=t.keyCode);var i=d(t);i&&("keyup"!=t.type||s!==i?e.handleKey(i,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):s=!1)}function f(t,e,r,o){function c(e){return function(){a=e,++n[t],clearTimeout(i),i=setTimeout(h,1e3)}}function l(e){u(r,e,t),"keyup"!==o&&(s=d(e)),setTimeout(h,10)}n[t]=0;for(var f=0;f<e.length;++f){var p=f+1===e.length?l:c(o||m(e[f+1]).action);v(e[f],p,o,t,f)}}function v(t,i,n,s,r){e._directMap[t+":"+n]=i;var o,a=(t=t.replace(/\s+/g," ")).split(" ");a.length>1?f(t,a,i,n):(o=m(t,n),e._callbacks[o.key]=e._callbacks[o.key]||[],c(o.key,o.modifiers,{type:o.action},s,t,r),e._callbacks[o.key][s?"unshift":"push"]({callback:i,modifiers:o.modifiers,action:o.action,seq:s,level:r,combo:t}))}e._handleKey=function(t,e,i){var n,s=c(t,e,i),r={},l=0,f=!1;for(n=0;n<s.length;++n)s[n].seq&&(l=Math.max(l,s[n].level));for(n=0;n<s.length;++n)if(s[n].seq){if(s[n].level!=l)continue;f=!0,r[s[n].seq]=1,u(s[n].callback,i,s[n].combo,s[n].seq)}else f||u(s[n].callback,i,s[n].combo);var p="keypress"==i.type&&o;i.type!=a||y(t)||p||h(r),o=f&&"keydown"==i.type},e._bindMultiple=function(t,e,i){for(var n=0;n<t.length;++n)v(t[n],e,i)},p(t,"keypress",l),p(t,"keydown",l),p(t,"keyup",l)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty,s="~";function r(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,i,n,r){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new o(i,n||t,r),h=s?s+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function c(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(s=!1)),c.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)n.call(t,e)&&i.push(s?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},c.prototype.listeners=function(t){var e=s?s+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,r=i.length,o=new Array(r);n<r;n++)o[n]=i[n].fn;return o},c.prototype.listenerCount=function(t){var e=s?s+t:t,i=this._events[e];return i?i.fn?1:i.length:0},c.prototype.emit=function(t,e,i,n,r,o){var a=s?s+t:t;if(!this._events[a])return!1;var h,c,u=this._events[a],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,n),!0;case 5:return u.fn.call(u.context,e,i,n,r),!0;case 6:return u.fn.call(u.context,e,i,n,r,o),!0}for(c=1,h=new Array(l-1);c<l;c++)h[c-1]=arguments[c];u.fn.apply(u.context,h)}else{var f,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),l){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,n);break;default:if(!h)for(f=1,h=new Array(l-1);f<l;f++)h[f-1]=arguments[f];u[c].fn.apply(u[c].context,h)}}return!0},c.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},c.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},c.prototype.removeListener=function(t,e,i,n){var r=s?s+t:t;if(!this._events[r])return this;if(!e)return h(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||n&&!o.once||i&&o.context!==i||h(this,r);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==e||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[r]=1===c.length?c[0]:c:h(this,r)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=s?s+t:t,this._events[e]&&h(this,e)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,t.exports=c},function(t,e,i){"use strict";i.r(e);const n="UP",s="DOWN",r="LEFT",o=document.getElementById("snake");document.body.style.margin="0px",document.body.style.height="100vh",o.width=document.body.offsetWidth,o.height=document.body.offsetHeight;var a=o;var h=i(1),c=i.n(h),u=i(0),l=i.n(u);const f=new c.a;l.a.bind("up",()=>{f.emit("move",n)}),l.a.bind("right",()=>{f.emit("move","RIGHT")}),l.a.bind("down",()=>{f.emit("move",s)}),l.a.bind("left",()=>{f.emit("move",r)}),l.a.bind("enter",()=>{f.emit("new_game")}),l.a.bind("space",()=>f.emit("new_game"));var p=f;const d=a.getContext("2d"),y=new class{constructor(t,e,i,n){this.c=t,this.width=e,this.height=i,this.grid={w:n,h:Math.round(n/e*i)},this.state="IDLE",this.radius=Math.round(e/n)/2,this.apple={x:null,y:null},this.position={x:null,y:null},this.direction=null,this.score=0,this.snake=[],this.wait=250,this.cooldown=250}newGame(){this.snake=[],this.snake.push({x:Math.round(this.grid.w/2),y:Math.round(this.grid.h/2)}),this.snake.push(this.snake[0]),this.snake.push(this.snake[0]),this.position=this.snake[0],this.randomDir(),this.placeApple(),this.score=0,this.state="STARTED",this.wait=250,this.cooldown=250}setDir(t){this.direction=t}getState(){return this.state}getScore(){return this.score}randomDir(){switch(Math.floor(3*Math.random())){case 0:return this.direction=n,n;case 1:return this.direction=r,r;case 2:return this.direction=s,s;default:return this.direction=null,null}}collision(t){var e;for(e=0;e<this.snake.length;e++)if(t.x===this.snake[e].x&&t.y===this.snake[e].y)return!0;return!1}randomPos(){return{x:Math.floor(Math.random()*this.grid.w),y:Math.floor(Math.random()*this.grid.h)}}placeApple(){for(var t=this.randomPos();this.collision(t);)t=this.randomPos();this.apple=t}move(t,e){this.position=t,e&&this.snake.pop(),this.snake.unshift(t),this.snake[0].from=this.directionDiff(this.snake[1],this.snake[0]),this.snake[1].from=this.directionDiff(this.snake[2],this.snake[1]),this.snake[1].to=this.directionDiff(this.snake[0],this.snake[1])}update(t){var e=Object.assign({},this.position);if(this.wait=this.wait-t,!(this.wait>0)){switch(this.wait=this.cooldown,this.direction){case n:e.y=e.y-1,e.y<0&&(e.y=this.grid.h-1);break;case"RIGHT":e.x=e.x+1,e.x>=this.grid.w&&(e.x=0);break;case s:e.y=e.y+1,e.y>=this.grid.h&&(e.y=0);break;case r:e.x=e.x-1,e.x<0&&(e.x=this.grid.w-1)}e.x===this.apple.x&&e.y===this.apple.y?(this.score=this.score+10,this.score<150&&(this.cooldown=250-this.score),this.placeApple(),this.move(e,!1)):this.collision(e)?(this.wait=0,this.state="ENDED"):this.move(e,!0)}}directionDiff(t,e){return Math.abs(t.x-e.x)>1||Math.abs(t.y-e.y)>1?t.x<e.x?"RIGHT":t.x>e.x?r:t.y<e.y?s:n:t.x<e.x?r:t.x>e.x?"RIGHT":t.y<e.y?n:s}render(){var t,e,i,o=(this.cooldown-this.wait)/this.cooldown*2,a=this.wait>this.cooldown/2;if("IDLE"!==this.state){for(this.c.strokeStyle="#ccc",t=1;t<this.grid.w;t++)this.c.moveTo(2*this.radius*t,0),this.c.lineTo(2*this.radius*t,this.height);for(t=1;t<this.grid.h;t++)this.c.moveTo(0,2*this.radius*t),this.c.lineTo(this.width,2*this.radius*t);for(this.c.stroke(),this.c.fillStyle="#f00",this.c.beginPath(),this.c.arc(this.apple.x*this.radius*2+this.radius,this.apple.y*this.radius*2+this.radius,this.radius,0,2*Math.PI),this.c.closePath(),this.c.fill(),this.c.fillStyle="#333",t=0;t<this.snake.length;t++){if(e=0,i=0,a)switch(this.snake[t].from){case n:i=this.radius*o-this.radius;break;case s:i=this.radius*o*-1+this.radius;break;case r:e=this.radius*o-this.radius;break;case"RIGHT":e=this.radius*o*-1+this.radius}else switch(this.snake[t].to||this.direction){case n:i=this.radius*o*-1+this.radius;break;case s:i=this.radius*o-this.radius;break;case r:e=this.radius*o*-1+this.radius;break;case"RIGHT":e=this.radius*o-this.radius}this.c.beginPath(),this.c.arc(this.snake[t].x*this.radius*2+e+this.radius,this.snake[t].y*this.radius*2+i+this.radius,this.radius,0,2*Math.PI),this.c.closePath(),this.c.fill()}}}}(d,a.width,a.height,30),v=a.width-40;let m,g=0;const w=()=>{const t=(new Date).getTime(),e=t-(m||t);switch(m=t,d.fillStyle="#eee",d.fillRect(0,0,a.width,a.height),y.update(e),y.render(),d.fillStyle="#999",d.font="32px sans-serif",y.getState()){case"IDLE":d.fillText("Press return/enter to start a new game",20,50,v);break;case"ENDED":d.fillText("GAME OVER!",20,50,v),d.fillText("Press return/enter to start a new game",20,100,v),y.getScore()>0&&y.getScore()>=g?(g=y.getScore(),d.fillText("Congratulations, new high score: "+g,20,150,v)):d.fillText("You scored "+y.getScore()+" points. Your high score is "+g,20,150,v);break;default:d.fillText(y.getScore(),20,50,v),requestAnimationFrame(w)}};requestAnimationFrame(w),p.on("move",t=>{y.setDir(t)}),p.on("new_game",()=>{y.newGame(),requestAnimationFrame(w)})}]);
//# sourceMappingURL=snake.js.map